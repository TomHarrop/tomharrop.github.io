% Layout
\setuppapersize[A4]
\setupalign[flushleft, nothyphenated, hanging]
\setupwhitespace[medium]
\setupindenting[no]
\setuppagenumbering[location=]

% PDF title
\setupinteraction[state=start, title=Thomas  Harrop]

% Type
\definefontfamily [mainface] [rm] [Lato]
\definefontfamily [mainface] [ss] [Lato]
\definefontfamily [mainface] [tt] [Inconsolatazi4] [tf=style:regular]
\definefontfamily [mainface] [mm] [Lato]
\setupbodyfont[mainface, 11pt]
\definefont[ms][Mono sa 1.1]
% \defineframed
%   [dohotkey]
%   [corner=00, location=low, backgroundoffset=-0.3em,
%    background=color, backgroundcolor=gray, frame=off]
% \definehspace[hotkey][0.5em]
% \def\hotkey#1{\dohotkey{\hspace[hotkey]#1\hspace[hotkey]}}
% \setuptype[style=\ms, command=\hotkey]
\setuptype[style=\ms]
\setuplanguage[en]
% \setuplanguage[en][spacing=packed]
\language[en]
\setbreakpoints[compound]
\setupinterlinespace

% 2-3 line lengths, see https://practicaltypography.com/line-length.html
\definemeasure[alphabet][\widthofstring{abcdefghijklmnopqrstuvwxyz}]
\definemeasure[myrulewidth][\dimexpr (\measure{alphabet}*2) \relax]
\definemeasure[mytextwidth][\dimexpr ((\measure{alphabet}*28)/10) \relax]
\definemeasure[mymargin][\dimexpr (\paperwidth-\measure{mytextwidth})/2 \relax ]

\setuplayout[width=\measure{mytextwidth},
             backspace=\measure{mymargin},
             marginspace=0mm,
             leftmargin=0mm,
             rightmargin=\measure{mymargin},
             edgedistance=0mm,
             leftedge=0mm,
             rightedge=0mm,
             height=middle,
             topspace=\measure{mymargin},
             header=0mm,
             footer=0mm]


% Colour
\setupcolor[hex]
\definecolor[sectioncolor]
  [h=2c3e50]

% Hyperlinks
\setupinteraction[state=start, color=sectioncolor, style=\bf\underbar]
\useURL[li] [https://linkedin.com/in/tom-harrop-41893011a]
\useURL[gh] [https://github.com/tomharrop]
\useURL[so] [https://stackoverflow.com/users/3017012/tom-harrop]
\useURL[orcid] [https://orcid.org/0000-0001-6557-0440]

\useURL[em] [mailto:twharrop@gmail.com]

% Headings
\setuphead[chapter]
  [style=\tfd]
\setuphead[section]
  [style=\tfb\bf, color=sectioncolor, align=middle]
\setuphead[subsection]
  [style=\tfa\bf, color=sectioncolor, align=flushleft]
\setuphead[subsubsection]
  [style=\bf, color=sectioncolor, align=flushleft]

\setuphead[chapter, section, subsection, subsubsection]
  [number=no, before={\blank[big]}, after={\blank[small]},
   indentnext=no]

% Heading levels
\definesectionlevels
   [default]
   [section,
    subsection,
    subsubsection]


% Descriptions
\definedescription[description]
  [alternative=left,
   width=\widthofstring{\bf{Reproducible research}},
   headstyle=bold, style=normal,
   headalign=flushright,
   before={\setupnarrower[right=0em, left=0em]%
           \startnarrower[right, left]},
   after={\stopnarrower}]

% negative indent for reference section
\definestartstop[negindent]
  [before={\setupnarrower[right=2em, left=2em]%
           \startnarrower[left]%
           \setupindenting[-\leftskip,yes,first]%
           \setuphead[subsection, subsubsection][indentnext=yes]},
   after={\stopnarrower%
          \setuphead[subsection, subsubsection][indentnext=no]}]

% width of horizontal rules
\define\thinrule{%
  \startalignment[center]%
  \midaligned{%
  \blackrule[
  width=\measure{myrulewidth},
  height=.5\linewidth, depth=.5\linewidth]}%
  \stopalignment
  }

% centre blockquotes
\setupdelimitedtext[blockquote]
  [before={\setupalign[middle]},
   indentnext=no]
\define\mybqstart{\startblockquote}
\define\mybqstop{\stopblockquote}


\starttext

\startsectionlevel[title={\blank[2*line]Thomas Harrop},reference={start}]

\startblockquote

\useURL[em2][mailto:twharrop@gmail.com][][twharrop@gmail.com]\from[em2] · \useURL[ws][http://tomharrop.io][][tomharrop.io]\from[ws]

\stopblockquote

$body$

\stopnegindent

\thinrule

\stopsectionlevel

\startblockquote

{\setupframed[frame=off,offset=none,align=middle,location=middle]

\useURL[em2][mailto:twharrop@gmail.com][][twharrop@gmail.com]\from[em2] · \useURL[ws][http://tomharrop.io][][tomharrop.io]\from[ws]

\blank[small]

\dontleavehmode%
\gotobox{\framed{%
  \externalfigure[src/img/GitHub-Mark][height=4ex]}}[url(gh)]%
\hskip1.5em%
\gotobox{\framed{%
  \externalfigure[src/img/In-2C-CMYK-2in-TM][height=4ex]}}[url(li)]%
\hskip1.5em%
\gotobox{\framed{%
  \externalfigure[src/img/ORCIDiD_icon64x64][height=4ex]}}[url(orcid)]

\blank[small]

Melbourne, AUSTRALIA}

\stopblockquote

\stoptext
